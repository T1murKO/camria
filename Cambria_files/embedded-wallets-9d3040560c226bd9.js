(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1321],{54604:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/apps/[app_id]/embedded-wallets",function(){return t(27874)}])},27874:function(e,a,t){"use strict";t.r(a),t.d(a,{__N_SSP:function(){return q},default:function(){return ee}});var r,d,n,i,s,o=t(52322),l=t(97729),c=t.n(l),_=t(2784),u=t(30195),m=((r=m||{}).APPLICATION_JSON="application/json",r),w=((d=w||{})[d.OK=200]="OK",d[d.CREATED=201]="CREATED",d[d.NO_CONTENT=204]="NO_CONTENT",d[d.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",d[d.MOVED_TEMPORARILY=302]="MOVED_TEMPORARILY",d[d.NOT_MODIFIED=304]="NOT_MODIFIED",d[d.BAD_REQUEST=400]="BAD_REQUEST",d[d.NOT_AUTHENTICATED=401]="NOT_AUTHENTICATED",d[d.FORBIDDEN=403]="FORBIDDEN",d[d.NOT_FOUND=404]="NOT_FOUND",d[d.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",d[d.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",d[d.UNPROCESSABLE_CONTENT=422]="UNPROCESSABLE_CONTENT",d[d.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",d[d.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",d[d.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",d[d.BAD_GATEWAY=502]="BAD_GATEWAY",d[d.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",d[d.GATEWAY_TIME_OUT=504]="GATEWAY_TIME_OUT",d[d.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",d),f=((n=f||{}).OAUTH_ACCOUNT_SUSPENDED="oauth_account_suspended",n.MISSING_OR_INVALID_PRIVY_APP_ID="missing_or_invalid_privy_app_id",n.MISSING_OR_INVALID_PRIVY_ACCOUNT_ID="missing_or_invalid_privy_account_id",n.MISSING_OR_INVALID_TOKEN="missing_or_invalid_token",n.MISSING_OR_INVALID_MFA="missing_or_invalid_mfa",n.EXPIRED_OR_INVALID_MFA_TOKEN="expired_or_invalid_mfa_token",n.INVALID_DATA="invalid_data",n.INVALID_CREDENTIALS="invalid_credentials",n.INVALID_CAPTCHA="invalid_captcha",n.LINKED_TO_ANOTHER_USER="linked_to_another_user",n.ALLOWLIST_REJECTED="allowlist_rejected",n.CANNOT_UNLINK_EMBEDDED_WALLET="cannot_unlink_embedded_wallet",n.CANNOT_UNLINK_SOLE_ACCOUNT="cannot_unlink_sole_account",n.CANNOT_LINK_MORE_OF_TYPE="cannot_link_more_of_type",n.LINKED_ACCOUNT_NOT_FOUND="linked_account_not_found",n.TOO_MANY_REQUESTS="too_many_requests",n.INVALID_ORIGIN="invalid_origin",n.MISSING_ORIGIN="missing_origin",n.INVALID_NATIVE_APP_ID="invalid_native_app_id",n.TOKEN_ALREADY_USED="token_already_used",n.ALREADY_LOGGED_OUT="already_logged_out",n.NOT_SUPPORTED="not_supported",n.USER_UNSUBSCRIBED="user_unsubscribed",n.MAX_APPS_REACHED="max_apps_reached",n.USER_LIMIT_REACHED="max_accounts_reached",n.DEVICE_REVOKED="device_revoked",n.WALLET_PASSWORD_EXISTS="wallet_password_exists",n.OAUTH_STATE_MISMATCH="oauth_state_mismatch",n.MAX_DENYLIST_ENTRIES_REACHED="max_denylist_entries_reached",n.DISALLOWED_LOGIN_METHOD="disallowed_login_method",n.LEGACY_DASHBOARD_LOGIN_CONFIGURATION="legacy_dashboard_login_configuration",n.CANNOT_SET_PASSWORD="cannot_set_password",n),p=(u.z.object({error:u.z.string(),cause:u.z.string().optional(),code:u.z.nativeEnum(f).optional()}),class extends Error{status;code;constructor(e,a,t){super(a),this.code=t,this.status=e}toString(){return`${this.constructor.name}: ${this.message}${this.cause?` [cause: ${this.cause}]`:""}`}}),v=class extends p{constructor(e,a){super(401,e,a)}},E=((i=E||{}).GET="get",i.POST="post",i.PATCH="patch",i.DELETE="delete",i.PUT="put",i),I=((s=I||{}).HTTP="http:",s.HTTPS="https:",s),N=t(41725),A=t(50429),T=t(48834).Buffer;async function y(e){let a=e.derivePath("m/3457'/10'/1'/0/".concat(0)),t=Uint8Array.from(T.from(a.privateKey.slice(2),"hex")),r=await (0,A.Cg)(t);return{publicKey:r,privateKey:t}}function h(e){return"0x".concat(A.UG.bytesToHex(e))}var O=t(68407);async function D(e){let{appId:a,rootNode:t,accessToken:r}=e,{publicKey:d}=await y(t);return await O.P3(a,h(d),{accessToken:r,mfaToken:null})}var g=t(81641),R=t(90162),S=t(79489),P=t(99558);async function M(e){let a,{farcasterSignerPrivateKey:t,fid:r,payload:d}=e,n=new g.vK({hubUrl:"https://hub-api.neynar.com",axiosInstance:R.default.create({headers:{api_key:P.Z.NEYNAR_API_KEY}})});if(1===d.type)a="like";else if(2===d.type)a="recast";else throw new S.AY("invalid_request_arguments","Invalid reaction type");if(!d.castId&&!d.targetUrl)throw new S.AY("invalid_request_arguments","Missing castId or targetUrl");let i=await n.submitReaction({type:a,target:d.castId||d.targetUrl},r,h(t));return i}async function U(e){let{farcasterSignerPrivateKey:a,fid:t,payload:r}=e,d=new g.vK({hubUrl:"https://hub-api.neynar.com",axiosInstance:R.default.create({headers:{api_key:P.Z.NEYNAR_API_KEY}})}),n=await d.removeCast(r,t,h(a));return n}async function L(e){let{farcasterSignerPrivateKey:a,fid:t,payload:r}=e,d=new g.vK({hubUrl:"https://hub-api.neynar.com",axiosInstance:R.default.create({headers:{api_key:P.Z.NEYNAR_API_KEY}})}),n=await d.removeLink(r,t,h(a));return n}async function C(e){let{farcasterSignerPrivateKey:a,fid:t,payload:r}=e,d=new g.vK({hubUrl:"https://hub-api.neynar.com",axiosInstance:R.default.create({headers:{api_key:P.Z.NEYNAR_API_KEY}})}),n=await d.submitCast(r,t,h(a));return n}async function b(e){let{farcasterSignerPrivateKey:a,fid:t,payload:r}=e,d=new g.vK({hubUrl:"https://hub-api.neynar.com",axiosInstance:R.default.create({headers:{api_key:P.Z.NEYNAR_API_KEY}})}),n=await d.submitLink(r,t,h(a));return n}var k=t(98437),x=t(8934);async function Y(e){let{appId:a,userId:t,address:r}=e;if(!(0,k.UJ)(r))throw new S.AY("invalid_request_arguments","Failed to initialize wallet: missing or invalid wallet address");let d=x.Z.get({appId:a,userId:t,address:r});if(!d)throw new S.AY("wallet_not_on_device","Failed to initialize wallet: wallet with address '".concat(r,"' not loaded on this device"))}var V=t(7186);async function K(e){var a;let{appId:t,accessToken:r,mfaCode:d,mfaMethod:n,userId:i}=e;if(d&&n)try{let e=await O.bf(t,r,n,d);return V.Z.set({appId:t,userId:i},e),e.token}catch(e){throw V.Z.del({appId:t,userId:i}),new S.AY("missing_or_invalid_mfa","MFA verification failed")}let s=null===(a=V.Z.get({appId:t,userId:i}))||void 0===a?void 0:a.token;return s||(V.Z.del({appId:t,userId:i}),null)}async function W(e){let{mfaCode:a,mfaMethod:t,...r}=e,d=await K({appId:r.appId,accessToken:r.accessToken,mfaCode:a,mfaMethod:t,userId:r.userId});switch(r.method){case"sms":return await O.J_(r.appId,r.accessToken,r.phoneNumber,d);case"totp":return await O.ls(r.appId,r.accessToken,d);default:throw Error("Unknown mfa method")}}async function H(e){switch(e.method){case"sms":return await O.Mc(e.appId,e.accessToken,e.code,e.phoneNumber);case"totp":return await O.GH(e.appId,e.accessToken,e.code);default:throw Error("Unknown mfa method")}}async function F(e){let{appId:a,userId:t,accessToken:r,method:d,mfaCode:n,mfaMethod:i}=e,s=await K({appId:a,accessToken:r,mfaCode:n,mfaMethod:i,userId:t}),o=await G({appId:a,accessToken:r,method:d,mfaToken:s});return V.Z.del({appId:a,userId:t}),o}async function G(e){let{appId:a,accessToken:t,method:r,mfaToken:d}=e;switch(r){case"sms":return await O.F5(a,t,d);case"totp":return await O.NO(a,t,d);default:throw Error("Unknown mfa method")}}var B=t(46686);function j(e){let{allowedOrigins:a,url:t}=e,r=new URL(t);if(0===a.length||a.some(e=>"*"===e.trim()))return!0;for(let e of a)if(r.origin===e||(function(e){let a=e.replace(/\./g,"\\.").replace(/\*/g,"[^.]*");return new RegExp("^".concat(a,"$"))})(e).test(r.origin))return!0;return!1}function Z(e){let{ReactNativeWebView:a}=e;return!!(a&&navigator.userAgent.includes("Android"))}let z={"privy:wallet:create":"embedded_wallet_iframe_create","privy:wallet:create-additional":"embedded_wallet_iframe_create_additional","privy:wallet:set-recovery-password":"embedded_wallet_iframe_set_recovery_password","privy:wallet:recover":"embedded_wallet_iframe_recover","privy:wallet:rpc":"embedded_wallet_iframe_rpc","privy:farcaster:init-signer":"embedded_wallet_iframe_farcaster_signer_init","privy:farcaster:submit-cast":"embedded_wallet_iframe_farcaster_submit_cast","privy:farcaster:remove-cast":"embedded_wallet_iframe_farcaster_remove_cast","privy:farcaster:react-to-cast":"embedded_wallet_iframe_farcaster_react_to_cast","privy:farcaster:submit-link":"embedded_wallet_iframe_farcaster_submit_link","privy:farcaster:remove-link":"embedded_wallet_iframe_farcaster_remove_link"};function J(e,a){var t,r,d;if(window.PRIVY_NATIVE_IOS)try{return null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers.iOSProxy.postMessage(JSON.stringify(e))}catch(e){}if(window.ReactNativeWebView)try{return null===(d=window.ReactNativeWebView)||void 0===d?void 0:null===(r=d.postMessage)||void 0===r?void 0:r.call(d,JSON.stringify(e))}catch(e){}setTimeout(()=>{window.parent&&window.parent.postMessage(e,a)},0)}function X(e,a,t,r){J({id:a,event:t,data:r},e.origin)}function $(e,a,t,r){let d=(0,S.d2)(r)?r.type:S.u$;J({id:a,event:t,error:{type:d,message:r.message}},e.origin)}function Q(e){let[a,t]=(0,_.useState)(null);function r(e,a,r){V.Z.get({appId:e,userId:a})?t(null):t(r)}return(0,_.useEffect)(()=>{window.location.href.startsWith("http://localhost")||(console.log("%cWarning!","color:#F16552; font-size:50px; font-weight: bold; -webkit-text-stroke: 1px black;"),console.log("%cYou are reading this message because you opened the browser console, a developer tool. Do not enter or paste code you do not understand. Never share your tokens or any other info with anyone. If someone told you to do this, it is very likely a scam.","font-size: 18px;"))},[]),(0,_.useEffect)(()=>{let t=e.appId,d=(0,B._)(t,e.apiUrl);async function n(t){var n,i,s,o,l,c,_,u,m,w,p,E,I;if(!t)return;let A="string"==typeof t.data?JSON.parse(t.data):t.data;if(!("string"==typeof A.event&&/^privy:.+/.test(A.event))||(E=e.allowedDomains,!(window.PRIVY_NATIVE_IOS||window.ReactNativeWebView||j({allowedOrigins:E,url:t.origin}))))return;if(!(0===(I=e.allowedDomains||[]).length?!(void 0!==location.ancestorOrigins&&location.ancestorOrigins.length>1):void 0===location.ancestorOrigins||!(location.ancestorOrigins.length>0)||[...location.ancestorOrigins].every(e=>j({allowedOrigins:I,url:e}))))return $(t,A.id,A.event,new v("Frame ancestor is not allowed"));if("privy:iframe:ready"===A.event)return X(t,A.id,A.event,{});let T=A.data.accessToken,h=T?await (0,B.r)(T,d,e.appId):null,{userId:g,appId:R}=null!=h?h:{userId:null,appId:null};try{if(!T||!g||!R)throw new v("Missing valid auth token.");let d=null!==(n=z[A.event])&&void 0!==n?n:"embedded_wallet_iframe_invalid_event",m=O.E2.bind(null,R,T,e.clientAnalyticsId);switch(z.hasOwnProperty(A.event)&&m("".concat(d,"_started")),A.event){case"privy:wallet:create":let{wallet:w}=await (0,N.EK)({appId:R,userId:g,accessToken:T,recoveryPassword:A.data.recoveryPassword,recoveryMethod:A.data.recoveryMethod,recoveryAccessToken:A.data.recoveryAccessToken,recoveryPin:A.data.recoveryPin});return m("".concat(d,"_completed"),{address:w.address}),X(t,A.id,A.event,{address:w.address});case"privy:wallet:create-additional":let{rootNode:f}=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.primaryWalletAddress,walletIndex:0,accessToken:T,mfaCode:null,mfaMethod:null}),p=await (0,N._r)(R,T,A.data,f);return m("".concat(d,"_completed"),{address:p.address}),X(t,A.id,A.event,{address:p.address});case"privy:wallet:set-recovery-password":let{wallet:E}=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod}),I=await (0,N.IA)({appId:R,userId:g,accessToken:T,wallet:E,data:A.data});return m("".concat(d,"_completed"),{address:I.address}),X(t,A.id,A.event,{address:I.address});case"privy:wallet:connect":return await Y({appId:R,userId:g,address:A.data.address}),X(t,A.id,A.event,{address:A.data.address});case"privy:wallet:recover":let h=await (0,N.IY)({appId:R,userId:g,accessToken:T,data:A.data});return m("".concat(d,"_completed"),{address:h.address}),X(t,A.id,A.event,{address:h.address});case"privy:wallet:rpc":let S=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:null!==(i=A.data.hdWalletIndex)&&void 0!==i?i:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod});r(R,g,S);let P=await (0,N.YF)(S.wallet,A.data);return m("".concat(d,"_completed"),{address:S.wallet.address,method:P.method}),X(t,A.id,A.event,{address:A.data.address,response:P});case"privy:mfa:verify":return await K({appId:R,userId:g,...A.data}),X(t,A.id,A.event,{});case"privy:mfa:init-enrollment":{let e=await W({appId:R,userId:g,...A.data});return X(t,A.id,A.event,{method:A.data.method,secret:e.totpSecret,authUrl:e.totpAuthUrl})}case"privy:mfa:submit-enrollment":return await H({appId:R,...A.data}),X(t,A.id,A.event,{});case"privy:mfa:unenroll":return await F({appId:R,userId:g,...A.data}),X(t,A.id,A.event,{});case"privy:farcaster:init-signer":{let e=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:null!==(s=A.data.hdWalletIndex)&&void 0!==s?s:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod});r(R,g,e);let n=await D({appId:R,rootNode:e.rootNode,accessToken:A.data.accessToken});return m("".concat(d,"_completed"),{address:e.wallet.address}),X(t,A.id,A.event,n)}case"privy:farcaster:submit-cast":{let e=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:null!==(o=A.data.hdWalletIndex)&&void 0!==o?o:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod});r(R,g,e);let{privateKey:n}=await y(e.rootNode),i=await C({farcasterSignerPrivateKey:n,fid:Number(A.data.fid),payload:A.data.payload});return m("".concat(d,"_completed"),{address:e.wallet.address}),X(t,A.id,A.event,{response:i})}case"privy:farcaster:remove-cast":{let e=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:null!==(l=A.data.hdWalletIndex)&&void 0!==l?l:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod});r(R,g,e);let{privateKey:n}=await y(e.rootNode),i=await U({farcasterSignerPrivateKey:n,fid:Number(A.data.fid),payload:A.data.payload});return m("".concat(d,"_completed"),{address:e.wallet.address}),X(t,A.id,A.event,{response:i})}case"privy:farcaster:react-to-cast":{let e=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:null!==(c=A.data.hdWalletIndex)&&void 0!==c?c:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod});r(R,g,e);let{privateKey:n}=await y(e.rootNode),i=await M({farcasterSignerPrivateKey:n,fid:Number(A.data.fid),payload:A.data.payload});return m("".concat(d,"_completed"),{address:e.wallet.address}),X(t,A.id,A.event,{response:i})}case"privy:farcaster:submit-link":{let e=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:null!==(_=A.data.hdWalletIndex)&&void 0!==_?_:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod});r(R,g,e);let{privateKey:n}=await y(e.rootNode),i=await b({farcasterSignerPrivateKey:n,fid:Number(A.data.fid),payload:A.data.payload});return m("".concat(d,"_completed"),{address:e.wallet.address}),X(t,A.id,A.event,{response:i})}case"privy:farcaster:remove-link":{let e=await (0,N.js)({cachedWallet:a,appId:R,userId:g,primaryAddress:A.data.address,walletIndex:null!==(u=A.data.hdWalletIndex)&&void 0!==u?u:0,accessToken:T,mfaCode:A.data.mfaCode,mfaMethod:A.data.mfaMethod});r(R,g,e);let{privateKey:n}=await y(e.rootNode),i=await L({farcasterSignerPrivateKey:n,fid:Number(A.data.fid),payload:A.data.payload});return m("".concat(d,"_completed"),{address:e.wallet.address}),X(t,A.id,A.event,{response:i})}}}catch(e){if(function(e){var a,t;let r=null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.code;return"missing_or_invalid_mfa"===r||"expired_or_invalid_mfa_token"===r}(e))return g&&V.Z.del({appId:R,userId:g}),$(t,A.id,A.event,new S.AY("missing_or_invalid_mfa","MFA verification failed"));if(function(e){var a,t,r;let d=null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.code,n=[f.INVALID_DATA,f.NOT_SUPPORTED,f.INVALID_DATA,f.NOT_SUPPORTED,f.USER_UNSUBSCRIBED].includes(d);return(null===(r=e.response)||void 0===r?void 0:r.status)===422&&n}(e))return g&&V.Z.del({appId:R,userId:g}),$(t,A.id,A.event,new S.AY("twilio_verification_failed",null!==(p=null===(w=e.response)||void 0===w?void 0:null===(m=w.data)||void 0===m?void 0:m.error)&&void 0!==p?p:"MFA enrollment failed"));return $(t,A.id,A.event,e)}}return Z(window)?document.addEventListener("message",n):window.addEventListener("message",n),()=>{Z(window)?document.removeEventListener("message",n):window.removeEventListener("message",n)}},[a,e.allowedDomains,e.appId]),null}var q=!0;function ee(e){let{appId:a,clientAnalyticsId:t,allowedDomains:r,apiUrl:d}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c(),{children:(0,o.jsx)("title",{children:"Wallet \xb7 Privy"})}),(0,o.jsx)(Q,{appId:a,clientAnalyticsId:t,allowedDomains:r,apiUrl:d})]})}}},function(e){e.O(0,[9034,4615,162,195,6862,737,2586,9774,2888,179],function(){return e(e.s=54604)}),_N_E=e.O()}]);